/*! For license information please see taskpane.js.LICENSE.txt */
!function(){var e={58394:function(e,t,n){"use strict";e.exports=n.p+"dc4a3d3f8c585f08ff85.css"},60947:function(e,t,n){"use strict";e.exports=n.p+"5de44b5f548d8643a252.js"}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,n),a.exports}n.m=e,n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=r[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b=document.baseURI||self.location.href,function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=o(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,c=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){s=!0,i=e},f:function(){try{c||null==n.return||n.return()}finally{if(s)throw i}}}}function n(t){if(null!=t){var n=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],r=0;if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}}throw new TypeError(e(t)+" is not iterable")}function r(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||o(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){if(e){if("string"==typeof e)return a(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function i(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var i=r&&r.prototype instanceof l?r:l,u=Object.create(i.prototype);return c(u,"_invoke",function(n,r,o){var a,i,c,l=0,u=o||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return a=t,i=0,c=e,f.n=n,s}};function p(n,r){for(i=n,c=r,t=0;!d&&l&&!o&&t<u.length;t++){var o,a=u[t],p=f.p,y=a[2];n>3?(o=y===r)&&(i=a[4]||3,c=a[5]===e?a[3]:a[5],a[4]=3,a[5]=e):a[0]<=p&&((o=n<2&&p<a[1])?(i=0,f.v=r,f.n=a[1]):p<y&&(o=n<3||a[0]>r||r>y)&&(a[4]=n,a[5]=r,f.n=y,i=0))}if(o||n>1)return s;throw d=!0,r}return function(o,u,y){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,y),i=u,c=y;(t=i<2?e:c)||!d;){a||(i?i<3?(i>1&&(f.n=-1),p(i,c)):f.n=c:f.v=c);try{if(l=2,a){if(i||(o="next"),t=a[o]){if(!(t=t.call(a,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,i<2&&(i=0)}else 1===i&&(t=a.return)&&t.call(a),i<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=e}else if((t=(d=f.n<0)?c:n.call(r,f))!==s)break}catch(t){a=e,i=1,c=t}finally{l=1}}return{value:t,done:d}}}(n,o,a),!0),u}var s={};function l(){}function u(){}function d(){}t=Object.getPrototypeOf;var f=[][r]?t(t([][r]())):(c(t={},r,(function(){return this})),t),p=d.prototype=l.prototype=Object.create(f);function y(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,c(e,o,"GeneratorFunction")),e.prototype=Object.create(p),e}return u.prototype=d,c(p,"constructor",d),c(d,"constructor",u),u.displayName="GeneratorFunction",c(d,o,"GeneratorFunction"),c(p),c(p,o,"Generator"),c(p,r,(function(){return this})),c(p,"toString",(function(){return"[object Generator]"})),(i=function(){return{w:a,m:y}})()}function c(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}c=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var a=function(t,n){c(e,t,(function(e){return this._invoke(t,n,e)}))};a("next",0),a("throw",1),a("return",2)}},c(e,t,n,r)}function s(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){s(a,r,o,i,c,"next",e)}function c(e){s(a,r,o,i,c,"throw",e)}i(void 0)}))}}var u={closing:[],postClosing:[],representation:[]},d=[],f=!1,p=!1,y=document.getElementById("dealSelect"),m=document.getElementById("sendDealButton"),g="";function h(){return v.apply(this,arguments)}function v(){return v=l(i().m((function e(){var t;return i().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,Word.run(function(){var e=l(i().m((function e(t){var n;return i().w((function(e){for(;;)switch(e.n){case 0:return(n=t.document.body).load("text"),e.n=1,t.sync();case 1:return e.n=2,k(n.text);case 2:g=e.v;case 3:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:e.n=3;break;case 2:e.p=2,t=e.v,console.error("Error setting initial content hash:",t);case 3:return e.a(2)}}),e,null,[[0,2]])}))),v.apply(this,arguments)}function b(){var e=document.getElementById("changeNotification");e&&(e.style.display="none")}function k(e){return w.apply(this,arguments)}function w(){return(w=l(i().m((function e(t){var n,r,o,a;return i().w((function(e){for(;;)switch(e.n){case 0:return n=new TextEncoder,r=n.encode(t),e.n=1,crypto.subtle.digest("SHA-256",r);case 1:return o=e.v,a=Array.from(new Uint8Array(o)),e.a(2,a.map((function(e){return e.toString(16).padStart(2,"0")})).join(""))}}),e)})))).apply(this,arguments)}function E(){return I.apply(this,arguments)}function I(){return I=l(i().m((function e(){var t;return i().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,Word.run(function(){var e=l(i().m((function e(t){var n,r,o;return i().w((function(e){for(;;)switch(e.n){case 0:return(n=t.document.body).load("text"),e.n=1,t.sync();case 1:return e.n=2,k(n.text);case 2:(r=e.v)!==g&&(g=r,(o=document.getElementById("changeNotification"))&&(o.style.display="block"));case 3:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:e.n=3;break;case 2:e.p=2,t=e.v,console.error("Error checking for document changes:",t);case 3:return e.a(2)}}),e,null,[[0,2]])}))),I.apply(this,arguments)}function S(){return x.apply(this,arguments)}function x(){return(x=l(i().m((function e(){var t;return i().w((function(e){for(;;)switch(e.n){case 0:return(t=document.getElementById("changeNotification"))&&(t.style.display="none"),e.n=1,h();case 1:return e.n=2,A();case 2:return e.a(2)}}),e)})))).apply(this,arguments)}function T(){return C.apply(this,arguments)}function C(){return(C=l(i().m((function e(){var t,n,r,o;return i().w((function(e){for(;;)switch(e.n){case 0:if(t=document.getElementById("categorySelect"),n=t.value,document.querySelectorAll(".category-content").forEach((function(e){e.classList.remove("active")})),r="".concat(n,"Content"),document.getElementById(r).classList.add("active"),document.getElementById("logStyleContentButton").disabled=!f||!n,!n||!u[n]){e.n=1;break}return o=H(n),e.n=1,B(o);case 1:return e.a(2)}}),e)})))).apply(this,arguments)}function B(e){return L.apply(this,arguments)}function L(){return(L=l(i().m((function e(t){var n;return i().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,navigator.clipboard.writeText(t);case 1:e.n=3;break;case 2:e.p=2,e.v,console.log("Fallback: using execCommand for copy"),(n=document.createElement("textarea")).value=t,n.style.position="fixed",n.style.left="-9999px",n.style.top="-9999px",document.body.appendChild(n);try{n.select(),document.execCommand("copy")}catch(e){console.error("Failed to copy text:",e)}finally{document.body.removeChild(n)}case 3:return e.a(2)}}),e,null,[[0,2]])})))).apply(this,arguments)}function O(e){return e.trim().replace(/^\.\s*/,"").replace(/\s+/g," ").replace(/[^\x20-\x7E]/g,"")}function A(){return N.apply(this,arguments)}function N(){return N=l(i().m((function e(){var t;return i().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,Word.run(function(){var e=l(i().m((function e(t){var o,a,c,s,l,u,p,y;return i().w((function(e){for(;;)switch(e.n){case 0:return o=t.document.body,(a=o.paragraphs).load("items, items/text, items/isListItem"),e.n=1,t.sync();case 1:return c=[],s="",l=(new Date).toISOString().split("T")[0],document.getElementById("logStyleContentButton").disabled=!0,f=!1,a.items.filter((function(e){return e.isListItem})).forEach((function(e){return e.listItem.load("level, listString")})),e.n=2,t.sync();case 2:u=i().m((function e(t){var n,o,u,f,p,y,m,g,h;return i().w((function(e){for(;;)switch(e.n){case 0:if(n=a.items[t],!((o=O(n.text)).length<=1)){e.n=1;break}return e.a(2,1);case 1:u=d.find((function(e){return e.index===t})),f="",n.isListItem?(p=n.listItem,y=p.level,m=p.listString||"",y<=c.length&&(c=c.slice(0,y)),c[y]=m,g=c.slice(0,y+1).filter(Boolean).join("."),s=g,f=u&&u.value!==o?"".concat(g," [Revised ").concat(l,"]"):g,d.push({key:f,value:o,originalText:n.text.trim().replace(/^\.\s*/,""),isListItem:!0,index:t,level:y,listString:m,parentNumbers:r(c)})):(h=s?"".concat(s," (text)"):"text_".concat(t+1),f=u&&u.value!==o?"".concat(h," [Revised ").concat(l,"]"):h,d.push({key:f,value:o,originalText:n.text.trim().replace(/^\.\s*/,""),isListItem:!1,index:t,level:-1}));case 2:return e.a(2)}}),e)})),p=0;case 3:if(!(p<a.items.length)){e.n=6;break}return e.d(n(u(p)),4);case 4:if(!e.v){e.n=5;break}return e.a(3,5);case 5:p++,e.n=3;break;case 6:d=d.filter((function(e){return!e.key.endsWith(".text")})),console.log("All paragraphs data loaded:",d),y=document.getElementById("categorySelect"),document.getElementById("logStyleContentButton").disabled=!y.value,f=!0;case 7:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:e.n=3;break;case 2:e.p=2,t=e.v,console.error("An error occurred while loading all paragraphs data:",t),t instanceof OfficeExtension.Error&&console.error("Debug info:",t.debugInfo),document.getElementById("logStyleContentButton").disabled=!0,f=!1;case 3:return e.a(2)}}),e,null,[[0,2]])}))),N.apply(this,arguments)}function j(){return D.apply(this,arguments)}function D(){return D=l(i().m((function e(){var o,a;return i().w((function(e){for(;;)switch(e.n){case 0:if(f){e.n=1;break}return console.log("Data is still loading. Please wait."),e.a(2);case 1:if(o=document.getElementById("categorySelect").value,console.log("Selected Category:",o),o){e.n=2;break}return console.log("No category selected"),e.a(2);case 2:return e.p=2,e.n=3,Word.run(function(){var e=l(i().m((function e(a){var c,s,l,f,p,y,m,g;return i().w((function(e){for(;;)switch(e.n){case 0:return c=a.document.getSelection(),(s=c.paragraphs).load("items"),e.n=1,a.sync();case 1:return s.items.map((function(e){return e.load("text,isListItem"),e.isListItem&&e.listItem.load("level,listString"),e})),e.n=2,a.sync();case 2:l=[],f=t(s.items),e.p=3,y=i().m((function e(){var t,n,r,a,c,s,f,y,m,g,h,v,b,k;return i().w((function(e){for(;;)switch(e.n){case 0:t=p.value,n=t.text.trim().replace(/^\.\s*/,""),r=O(n),(a=d.filter((function(e){return e.value===r||e.originalText===n}))).length>0&&(c=a[0],a.length>1&&t.isListItem&&(s=t.listItem.level,f=t.listItem.listString,(y=a.find((function(e){return e.isListItem&&e.level===s&&e.listString===f})))&&(c=y)),u[o].some((function(e){return e.key===c.key&&e.value===c.value}))||("closing"===o||"postClosing"===o?c.key?(m=c.key.split(/(?<=^[^\d]+)(?=\d)/),g=m[0].trim().replace(/\.$/,""),h=c.key.trim(),v=c.value.trim(),b=d.find((function(e){return e.key.trim()===g})),k=b?g+" "+b.value:g,l.push({mainHeading:k,sectionHeading:h,content:v})):console.error("bestMatch.key is undefined, skipping 'closing' category handling."):l.push({key:c.key,value:c.value})));case 1:return e.a(2)}}),e)})),f.s();case 4:if((p=f.n()).done){e.n=6;break}return e.d(n(y()),5);case 5:e.n=4;break;case 6:e.n=8;break;case 7:e.p=7,g=e.v,f.e(g);case 8:return e.p=8,f.f(),e.f(8);case 9:if(!(l.length>0)){e.n=11;break}return u[o]=[].concat(r(u[o]),l),u[o].sort((function(e,t){for(var n=e.key?e.key.split(".").map((function(e){return parseInt(e)})):[],r=t.key?t.key.split(".").map((function(e){return parseInt(e)})):[],o=0;o<Math.max(n.length,r.length);o++){if(isNaN(n[o]))return 1;if(isNaN(r[o]))return-1;if(n[o]!==r[o])return n[o]-r[o]}return 0})),_(o),"closing"===o||"postClosing"===o?(console.log("Formatting closing checklist data"),m=P(o)):m=H(o),e.n=10,R(m);case 10:console.log("Updated ".concat(o," data:"),u[o]);case 11:return e.a(2)}}),e,null,[[3,7,8,9]])})));return function(t){return e.apply(this,arguments)}}());case 3:e.n=5;break;case 4:e.p=4,a=e.v,console.error("An error occurred while processing selection:",a),a instanceof OfficeExtension.Error&&console.error("Debug info:",a.debugInfo);case 5:return e.a(2)}}),e,null,[[2,4]])}))),D.apply(this,arguments)}function H(e){if(!u[e]||!Array.isArray(u[e]))return console.error("Invalid category data for:",e),"{}";if("closing"===e||"postClosing"===e)return P(e);var t=u[e].map((function(e){return'"'.concat(e.key,'": "').concat(e.value.replace(/"/g,'\\"'),'"')})).join(",\n");return"{\n".concat(t,"\n}")}function P(e){var t=u[e];if(!Array.isArray(t))return console.error("Invalid selections data for category:",e),"{}";var n={};return t.forEach((function(e){if(e.mainHeading&&e.sectionHeading&&e.content){var t=e.mainHeading.trim(),r=e.sectionHeading.trim(),o=e.content.trim(),a=r.split(".").map((function(e){return e.trim()})),i=t.split(".").map((function(e){return e.trim()}));0!==a.length&&0!==i.length?(n[t]||(n[t]={title:t,sections:[]}),n[t].sections.push({sectionHeading:r,content:o})):console.error("Invalid section heading or main heading format:",e)}else console.error("Missing data in selection:",e)})),JSON.stringify(n,null,2)}function _(e){var t=document.querySelector("#".concat(e,"Content .content-area"));t?(console.log("".concat(e," array:"),u),t.innerHTML="",u[e]&&u[e].forEach((function(n){if("closing"===e||"postClosing"===e)[{key:"Article",value:n.mainHeading},{key:"Section",value:n.sectionHeading},{key:"Clause",value:n.content}].forEach((function(e){var n='<span class="key">'.concat(e.key,"</span>"),r='<span class="value">'.concat(e.value,"</span>"),o='<div class="pair">'.concat(n,": ").concat(r,"</div>");t.innerHTML+=o})),t.innerHTML+="<br><br>";else{var r='<span class="key">'.concat(n.key,"</span>"),o='<span class="value">'.concat(n.value,"</span>"),a='<div class="pair">'.concat(r,": ").concat(o,"</div>");t.innerHTML+=a}}))):console.error("Content element not found for category:",e)}function R(e){return F.apply(this,arguments)}function F(){return(F=l(i().m((function e(t){var n;return i().w((function(e){for(;;)switch(e.n){case 0:if(t){e.n=1;break}return console.error("No text provided to copy"),M(!1),e.a(2);case 1:return e.p=1,e.n=2,navigator.clipboard.writeText(t);case 2:M(!0),e.n=4;break;case 3:e.p=3,e.v,console.log("Fallback: using execCommand for copy"),(n=document.createElement("textarea")).value=t,n.style.position="fixed",n.style.left="-9999px",n.style.top="-9999px",document.body.appendChild(n);try{n.select(),M(document.execCommand("copy"))}catch(e){console.error("Failed to copy text:",e),M(!1)}finally{document.body.removeChild(n)}case 4:return e.a(2)}}),e,null,[[1,3]])})))).apply(this,arguments)}function M(e){var t=document.getElementById("copyMessage");t?(t.style.display="block",t.textContent=e?"Content added and copied to clipboard!":"Failed to copy content",t.style.color=e?"green":"red",setTimeout((function(){t.style.display="none"}),3e3)):console.error("Copy message element not found")}function U(){return G.apply(this,arguments)}function G(){return(G=l(i().m((function e(){var t,n;return i().w((function(e){for(;;)switch(e.n){case 0:if(t=document.getElementById("categorySelect").value){e.n=1;break}return console.log("No category selected"),e.a(2);case 1:return u[t]=[],(n=document.querySelector("#".concat(t,"Content .content-area")))&&(n.innerHTML=""),e.n=2,B("{}");case 2:console.log("Cleared content for category: ".concat(t));case 3:return e.a(2)}}),e)})))).apply(this,arguments)}Office.onReady((function(e){if(e.host===Office.HostType.Word){var t=document.getElementById("logStyleContentButton"),n=document.getElementById("categorySelect"),r=document.getElementById("reloadButton"),o=document.getElementById("dismissNotification"),a=document.getElementById("dealOptions");t.disabled=!0,t.onclick=j,document.getElementById("clearContentButton").onclick=U,r.onclick=S,o&&(o.onclick=b),n.onchange=T,T(),h(),setInterval(E,2e3),A();var c=document.getElementById("loginButton"),s=document.getElementById("loginModal"),u=document.getElementById("loginForm"),d=document.querySelector(".close-modal"),f=document.getElementById("loginError");c.addEventListener("click",(function(){p?(p=!1,authToken=null,localStorage.removeItem("authToken"),c.textContent="Login To Deal Driver",a.style.display="none",document.getElementById("mainContent").classList.add("hidden")):s.style.display="block"})),d.addEventListener("click",(function(){s.style.display="none",f.style.display="none"})),window.addEventListener("click",(function(e){e.target===s&&(s.style.display="none",f.style.display="none")})),u.addEventListener("submit",function(){var e=l(i().m((function e(t){var n,r;return i().w((function(e){for(;;)switch(e.n){case 0:return t.preventDefault(),n=document.getElementById("userName").value,r=document.getElementById("password").value,e.n=1,$(n,r);case 1:e.v?(p=!0,c.textContent="Logout",s.style.display="none",f.style.display="none",u.reset(),a.style.display="block"):f.style.display="block";case 2:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}())}}));var W,J=null;function $(e,t){return q.apply(this,arguments)}function q(){return(q=l(i().m((function e(t,n){var r,o,a,c,s,l,u,d;return i().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,r=document.getElementById("environmentSelect"),W=r.value,console.log("This is the selected Environment: ",W),o="production"===W?"https://deal-driver-20245869.api.drapcode.io/api/v1/developer/login":"preview"===W?"https://deal-driver-20245869.api.preview.drapcode.io/api/v1/developer/login":"https://deal-driver-20245869.api.sandbox.drapcode.io/api/v1/developer/login",e.n=1,fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userName:t,password:n})});case 1:if(!(a=e.v).ok){e.n=3;break}return e.n=2,a.json();case 2:return s=e.v,console.log("This is the API response data",s),localStorage.setItem("loginResponseData",JSON.stringify(s)),J=s,console.log("This is the login response variable: ",J),localStorage.setItem("authToken",s.token),l=(null===(c=s.userDetails)||void 0===c?void 0:c.tenantId)||[],(u=document.getElementById("dealSelect")).innerHTML="",l.forEach((function(e){var t=document.createElement("option");t.value=e._id,console.log("These are the option value ",t.value),t.textContent=e.name,u.appendChild(t)})),l.length>0?document.getElementById("dealOptions").style.display="block":document.getElementById("dealOptions").style.display="none",document.getElementById("mainContent").classList.remove("hidden"),e.a(2,!0);case 3:return console.error("Login failed with status:",a.status),e.a(2,!1);case 4:e.n=6;break;case 5:return e.p=5,d=e.v,console.error("Login error:",d),e.a(2,!1);case 6:return e.a(2)}}),e,null,[[0,5]])})))).apply(this,arguments)}m.addEventListener("click",l(i().m((function e(){var t,n,r,o,a,c,s,l,d,f,p,g,h,v,b,k,w,E,I,S,x,T,C,B,L,O,A,N,j;return i().w((function(e){for(;;)switch(e.n){case 0:if((t=document.getElementById("dealSendMessage"))||((t=document.createElement("div")).id="dealSendMessage",t.style.position="absolute",t.style.top="-50px",t.style.left="0",t.style.width="100%",t.style.padding="10px",t.style.textAlign="center",t.style.transition="top 0.3s ease",m.parentNode.insertBefore(t,m)),n=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t.textContent=e,t.style.backgroundColor=n?"#ffdddd":"#ddffdd",t.style.color=n?"red":"green",t.style.top="0",setTimeout((function(){t.style.top="-50px"}),9e3)},m.disabled=!0,m.style.opacity="0.5",m.style.cursor="not-allowed",e.p=1,r=y.options[y.selectedIndex].text,o=document.getElementById("categorySelect").value,console.log("This is the selected category: ",o),a=localStorage.getItem("loginResponseData"),c=W,console.log("Backend for selecting env: ",W),a){e.n=2;break}return n("Login data not found",!0),e.a(2);case 2:if(s=JSON.parse(a),l=s.userDetails.tenantId||[],console.log("This is the dealsArray which contains all the data: ",l),d=l.find((function(e){return e.name===r})),console.log("This is the matched Deal: ",d),d){e.n=3;break}return n("Could not find matching deal",!0),e.a(2);case 3:if(f=d.deal[0].deal_user_setting,console.log("This is the matchedDealSettingUUID: ",f),"sandbox"===c?p="https://deal-driver-20245869.api.sandbox.drapcode.io":"preview"===c?p="https://deal-driver-20245869.api.preview.drapcode.io":"production"===c&&(p="https://deal-driver-20245869.api.drapcode.io"),console.log("This is the base url : ",p),!p){e.n=6;break}return e.n=4,fetch("".concat(p,"/api/v1/developer/collection/user_setting/item/").concat(f));case 4:return h=e.v,e.n=5,h.json();case 5:g=e.v,console.log("This is the dealSettingData: ",g),e.n=7;break;case 6:console.error("Invalid environment selected.");case 7:if(console.log("This is the final data before giving any error: ",g),v=g.permissions||[],b=["CREATE_POST_CLOSING_CHECKLIST","CREATE_REPRESENTATION_WARRANTY","CREATE_REVISED_CLOSING_CHECKLIST"],k=v.filter((function(e){return b.includes(e)})),console.log("Filtered AREA Permissions: ",k),w=d.deal[0].uuid,console.log("This is matched deal id: ",d.deal[0].uuid),E=s.tenant.uuid,"closing"!==o){e.n=13;break}return e.n=8,fetch("https://dealdriverapi.drapcode.co/addClosingData",{method:"POST",headers:{"Content-Type":"application/json",dealId:w,tenantId:E,environment:c,permissions:k},body:P(o)});case 8:if(I=e.v,console.log("This is the body of the data being sent in the localhost: ",P(o)),!I.ok){e.n=10;break}return e.n=9,I.json();case 9:S=e.v,n("".concat(o," data sent successfully to ").concat(r)),console.log("Server response:",S),e.n=12;break;case 10:return e.n=11,I.text();case 11:x=e.v,n("Error while sending the data",!0),console.error("Failed to send deal. Status: ".concat(I.status)),console.error("Error details:",x);case 12:console.log("This is the response data of the preview api",I),e.n=24;break;case 13:if("postClosing"!==o){e.n=19;break}return e.n=14,fetch("https://dealdriverapi.drapcode.co/addPostClosingData",{method:"POST",headers:{"Content-Type":"application/json",dealId:w,tenantId:E,environment:c,permissions:k},body:P(o)});case 14:if(T=e.v,console.log("This is the body of the data being sent in the localhost: ",P(o)),!T.ok){e.n=16;break}return e.n=15,T.json();case 15:C=e.v,n("".concat(o," data sent successfully to ").concat(r)),console.log("Server response:",C),e.n=18;break;case 16:return e.n=17,T.text();case 17:B=e.v,n("Error while sending the data",!0),console.error("Failed to send deal. Status: ".concat(T.status)),console.error("Error details:",B);case 18:console.log("This is the response data of the preview api",T),console.log("The selected Category is post closing"),e.n=24;break;case 19:return L=u[o].reduce((function(e,t){return e[t.key]=t.value,e}),{}),console.log("This the formattedCategoryData that is being parsed before sending to the api: ",L),e.n=20,fetch("https://dealdriverapi.drapcode.co/parseWord",{method:"POST",headers:{"Content-Type":"application/json",dealId:w,tenantId:E,environment:c,permissions:k},body:JSON.stringify(L)});case 20:if(!(O=e.v).ok){e.n=22;break}return e.n=21,O.json();case 21:A=e.v,n("".concat(o," data sent successfully to ").concat(r)),console.log("Server response:",A),e.n=24;break;case 22:return e.n=23,O.text();case 23:N=e.v,n(N,!0),console.error("Failed to send deal. Status: ".concat(O.status)),console.error("Error details:",N);case 24:e.n=26;break;case 25:e.p=25,j=e.v,n("Error sending deal",!0),console.error("Error sending deal:",j);case 26:return e.p=26,m.disabled=!1,m.style.opacity="1",m.style.cursor="pointer",e.f(26);case 27:return e.a(2)}}),e,null,[[1,25,26,27]])}))))}(),function(){"use strict";new URL(n(60947),n.b),new URL(n(58394),n.b)}()}();
//# sourceMappingURL=taskpane.js.map