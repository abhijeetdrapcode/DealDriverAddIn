/*! For license information please see 5de44b5f548d8643a252.js.LICENSE.txt */
function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _createForOfIteratorHelper(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw a}}}}function _regeneratorValues(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(_typeof(e)+" is not iterable")}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function _regenerator(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var c=r&&r.prototype instanceof s?r:s,l=Object.create(c.prototype);return _regeneratorDefine2(l,"_invoke",function(n,r,o){var a,s,c,l=0,u=o||[],d=!1,p={p:0,n:0,v:e,a:g,f:g.bind(e,4),d:function(t,n){return a=t,s=0,c=e,p.n=n,i}};function g(n,r){for(s=n,c=r,t=0;!d&&l&&!o&&t<u.length;t++){var o,a=u[t],g=p.p,y=a[2];n>3?(o=y===r)&&(s=a[4]||3,c=a[5]===e?a[3]:a[5],a[4]=3,a[5]=e):a[0]<=g&&((o=n<2&&g<a[1])?(s=0,p.v=r,p.n=a[1]):g<y&&(o=n<3||a[0]>r||r>y)&&(a[4]=n,a[5]=r,p.n=y,s=0))}if(o||n>1)return i;throw d=!0,r}return function(o,u,y){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&g(u,y),s=u,c=y;(t=s<2?e:c)||!d;){a||(s?s<3?(s>1&&(p.n=-1),g(s,c)):p.n=c:p.v=c);try{if(l=2,a){if(s||(o="next"),t=a[o]){if(!(t=t.call(a,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=a.return)&&t.call(a),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);a=e}else if((t=(d=p.n<0)?c:n.call(r,p))!==i)break}catch(t){a=e,s=1,c=t}finally{l=1}}return{value:t,done:d}}}(n,o,a),!0),l}var i={};function s(){}function c(){}function l(){}t=Object.getPrototypeOf;var u=[][r]?t(t([][r]())):(_regeneratorDefine2(t={},r,(function(){return this})),t),d=l.prototype=s.prototype=Object.create(u);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,_regeneratorDefine2(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return c.prototype=l,_regeneratorDefine2(d,"constructor",l),_regeneratorDefine2(l,"constructor",c),c.displayName="GeneratorFunction",_regeneratorDefine2(l,o,"GeneratorFunction"),_regeneratorDefine2(d),_regeneratorDefine2(d,o,"Generator"),_regeneratorDefine2(d,r,(function(){return this})),_regeneratorDefine2(d,"toString",(function(){return"[object Generator]"})),(_regenerator=function(){return{w:a,m:p}})()}function _regeneratorDefine2(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}_regeneratorDefine2=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var a=function(t,n){_regeneratorDefine2(e,t,(function(e){return this._invoke(t,n,e)}))};a("next",0),a("throw",1),a("return",2)}},_regeneratorDefine2(e,t,n,r)}function asyncGeneratorStep(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function _asyncToGenerator(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){asyncGeneratorStep(a,r,o,i,s,"next",e)}function s(e){asyncGeneratorStep(a,r,o,i,s,"throw",e)}i(void 0)}))}}var categoryData={closing:[],postClosing:[],representation:[]},allParagraphsData=[],isDataLoaded=!1,isLoggedIn=!1,dealSelect=document.getElementById("dealSelect"),sendDealButton=document.getElementById("sendDealButton"),documentContentHash="";function setInitialContentHash(){return _setInitialContentHash.apply(this,arguments)}function _setInitialContentHash(){return _setInitialContentHash=_asyncToGenerator(_regenerator().m((function e(){var t;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,Word.run(function(){var e=_asyncToGenerator(_regenerator().m((function e(t){var n;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return(n=t.document.body).load("text"),e.n=1,t.sync();case 1:return e.n=2,calculateHash(n.text);case 2:documentContentHash=e.v;case 3:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:e.n=3;break;case 2:e.p=2,t=e.v,console.error("Error setting initial content hash:",t);case 3:return e.a(2)}}),e,null,[[0,2]])}))),_setInitialContentHash.apply(this,arguments)}function dismissChangeNotification(){var e=document.getElementById("changeNotification");e&&(e.style.display="none")}function calculateHash(e){return _calculateHash.apply(this,arguments)}function _calculateHash(){return(_calculateHash=_asyncToGenerator(_regenerator().m((function e(t){var n,r,o,a;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return n=new TextEncoder,r=n.encode(t),e.n=1,crypto.subtle.digest("SHA-256",r);case 1:return o=e.v,a=Array.from(new Uint8Array(o)),e.a(2,a.map((function(e){return e.toString(16).padStart(2,"0")})).join(""))}}),e)})))).apply(this,arguments)}function checkForDocumentChanges(){return _checkForDocumentChanges.apply(this,arguments)}function _checkForDocumentChanges(){return _checkForDocumentChanges=_asyncToGenerator(_regenerator().m((function e(){var t;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,Word.run(function(){var e=_asyncToGenerator(_regenerator().m((function e(t){var n,r,o;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return(n=t.document.body).load("text"),e.n=1,t.sync();case 1:return e.n=2,calculateHash(n.text);case 2:(r=e.v)!==documentContentHash&&(documentContentHash=r,(o=document.getElementById("changeNotification"))&&(o.style.display="block"));case 3:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:e.n=3;break;case 2:e.p=2,t=e.v,console.error("Error checking for document changes:",t);case 3:return e.a(2)}}),e,null,[[0,2]])}))),_checkForDocumentChanges.apply(this,arguments)}function handleReloadContent(){return _handleReloadContent.apply(this,arguments)}function _handleReloadContent(){return(_handleReloadContent=_asyncToGenerator(_regenerator().m((function e(){var t;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return(t=document.getElementById("changeNotification"))&&(t.style.display="none"),e.n=1,setInitialContentHash();case 1:return e.n=2,loadAllParagraphsData();case 2:return e.a(2)}}),e)})))).apply(this,arguments)}function handleCategoryChange(){return _handleCategoryChange.apply(this,arguments)}function _handleCategoryChange(){return(_handleCategoryChange=_asyncToGenerator(_regenerator().m((function e(){var t,n,r,o;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:if(t=document.getElementById("categorySelect"),n=t.value,document.querySelectorAll(".category-content").forEach((function(e){e.classList.remove("active")})),r="".concat(n,"Content"),document.getElementById(r).classList.add("active"),document.getElementById("logStyleContentButton").disabled=!isDataLoaded||!n,!n||!categoryData[n]){e.n=1;break}return o=formatCategoryData(n),e.n=1,silentCopyToClipboard(o);case 1:return e.a(2)}}),e)})))).apply(this,arguments)}function silentCopyToClipboard(e){return _silentCopyToClipboard.apply(this,arguments)}function _silentCopyToClipboard(){return(_silentCopyToClipboard=_asyncToGenerator(_regenerator().m((function e(t){var n;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,navigator.clipboard.writeText(t);case 1:e.n=3;break;case 2:e.p=2,e.v,console.log("Fallback: using execCommand for copy"),(n=document.createElement("textarea")).value=t,n.style.position="fixed",n.style.left="-9999px",n.style.top="-9999px",document.body.appendChild(n);try{n.select(),document.execCommand("copy")}catch(e){console.error("Failed to copy text:",e)}finally{document.body.removeChild(n)}case 3:return e.a(2)}}),e,null,[[0,2]])})))).apply(this,arguments)}function normalizeText(e){return e.trim().replace(/^\.\s*/,"").replace(/\s+/g," ").replace(/[^\x20-\x7E]/g,"")}function loadAllParagraphsData(){return _loadAllParagraphsData.apply(this,arguments)}function _loadAllParagraphsData(){return _loadAllParagraphsData=_asyncToGenerator(_regenerator().m((function e(){var t;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,Word.run(function(){var e=_asyncToGenerator(_regenerator().m((function e(t){var n,r,o,a,i,s,c,l;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return n=t.document.body,(r=n.paragraphs).load("items, items/text, items/isListItem"),e.n=1,t.sync();case 1:return o=[],a="",i=(new Date).toISOString().split("T")[0],document.getElementById("logStyleContentButton").disabled=!0,isDataLoaded=!1,r.items.filter((function(e){return e.isListItem})).forEach((function(e){return e.listItem.load("level, listString")})),e.n=2,t.sync();case 2:s=_regenerator().m((function e(t){var n,s,c,l,u,d,p,g,y;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:if(n=r.items[t],!((s=normalizeText(n.text)).length<=1)){e.n=1;break}return e.a(2,1);case 1:c=allParagraphsData.find((function(e){return e.index===t})),l="",n.isListItem?(u=n.listItem,d=u.level,p=u.listString||"",d<=o.length&&(o=o.slice(0,d)),o[d]=p,g=o.slice(0,d+1).filter(Boolean).join("."),a=g,l=c&&c.value!==s?"".concat(g," [Revised ").concat(i,"]"):g,allParagraphsData.push({key:l,value:s,originalText:n.text.trim().replace(/^\.\s*/,""),isListItem:!0,index:t,level:d,listString:p,parentNumbers:_toConsumableArray(o)})):(y=a?"".concat(a," (text)"):"text_".concat(t+1),l=c&&c.value!==s?"".concat(y," [Revised ").concat(i,"]"):y,allParagraphsData.push({key:l,value:s,originalText:n.text.trim().replace(/^\.\s*/,""),isListItem:!1,index:t,level:-1}));case 2:return e.a(2)}}),e)})),c=0;case 3:if(!(c<r.items.length)){e.n=6;break}return e.d(_regeneratorValues(s(c)),4);case 4:if(!e.v){e.n=5;break}return e.a(3,5);case 5:c++,e.n=3;break;case 6:allParagraphsData=allParagraphsData.filter((function(e){return!e.key.endsWith(".text")})),console.log("All paragraphs data loaded:",allParagraphsData),l=document.getElementById("categorySelect"),document.getElementById("logStyleContentButton").disabled=!l.value,isDataLoaded=!0;case 7:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:e.n=3;break;case 2:e.p=2,t=e.v,console.error("An error occurred while loading all paragraphs data:",t),t instanceof OfficeExtension.Error&&console.error("Debug info:",t.debugInfo),document.getElementById("logStyleContentButton").disabled=!0,isDataLoaded=!1;case 3:return e.a(2)}}),e,null,[[0,2]])}))),_loadAllParagraphsData.apply(this,arguments)}function getListInfoFromSelection(){return _getListInfoFromSelection.apply(this,arguments)}function _getListInfoFromSelection(){return _getListInfoFromSelection=_asyncToGenerator(_regenerator().m((function e(){var t,n;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:if(isDataLoaded){e.n=1;break}return console.log("Data is still loading. Please wait."),e.a(2);case 1:if(t=document.getElementById("categorySelect").value,console.log("Selected Category:",t),t){e.n=2;break}return console.log("No category selected"),e.a(2);case 2:return e.p=2,e.n=3,Word.run(function(){var e=_asyncToGenerator(_regenerator().m((function e(n){var r,o,a,i,s,c,l,u;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return r=n.document.getSelection(),(o=r.paragraphs).load("items"),e.n=1,n.sync();case 1:return o.items.map((function(e){return e.load("text,isListItem"),e.isListItem&&e.listItem.load("level,listString"),e})),e.n=2,n.sync();case 2:a=[],i=_createForOfIteratorHelper(o.items),e.p=3,c=_regenerator().m((function e(){var n,r,o,i,c,l,u,d,p,g,y,f,m,h;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:n=s.value,r=n.text.trim().replace(/^\.\s*/,""),o=normalizeText(r),(i=allParagraphsData.filter((function(e){return e.value===o||e.originalText===r}))).length>0&&(c=i[0],i.length>1&&n.isListItem&&(l=n.listItem.level,u=n.listItem.listString,(d=i.find((function(e){return e.isListItem&&e.level===l&&e.listString===u})))&&(c=d)),categoryData[t].some((function(e){return e.key===c.key&&e.value===c.value}))||("closing"===t||"postClosing"===t?c.key?(p=c.key.split(/(?<=^[^\d]+)(?=\d)/),g=p[0].trim().replace(/\.$/,""),y=c.key.trim(),f=c.value.trim(),m=allParagraphsData.find((function(e){return e.key.trim()===g})),h=m?g+" "+m.value:g,a.push({mainHeading:h,sectionHeading:y,content:f})):console.error("bestMatch.key is undefined, skipping 'closing' category handling."):a.push({key:c.key,value:c.value})));case 1:return e.a(2)}}),e)})),i.s();case 4:if((s=i.n()).done){e.n=6;break}return e.d(_regeneratorValues(c()),5);case 5:e.n=4;break;case 6:e.n=8;break;case 7:e.p=7,u=e.v,i.e(u);case 8:return e.p=8,i.f(),e.f(8);case 9:if(!(a.length>0)){e.n=11;break}return categoryData[t]=[].concat(_toConsumableArray(categoryData[t]),a),categoryData[t].sort((function(e,t){for(var n=e.key?e.key.split(".").map((function(e){return parseInt(e)})):[],r=t.key?t.key.split(".").map((function(e){return parseInt(e)})):[],o=0;o<Math.max(n.length,r.length);o++){if(isNaN(n[o]))return 1;if(isNaN(r[o]))return-1;if(n[o]!==r[o])return n[o]-r[o]}return 0})),updateCategoryDisplay(t),"closing"===t||"postClosing"===t?(console.log("Formatting closing checklist data"),l=formatClosingChecklistData(t)):l=formatCategoryData(t),e.n=10,copyToClipboard(l);case 10:console.log("Updated ".concat(t," data:"),categoryData[t]);case 11:return e.a(2)}}),e,null,[[3,7,8,9]])})));return function(t){return e.apply(this,arguments)}}());case 3:e.n=5;break;case 4:e.p=4,n=e.v,console.error("An error occurred while processing selection:",n),n instanceof OfficeExtension.Error&&console.error("Debug info:",n.debugInfo);case 5:return e.a(2)}}),e,null,[[2,4]])}))),_getListInfoFromSelection.apply(this,arguments)}function formatCategoryData(e){if(!categoryData[e]||!Array.isArray(categoryData[e]))return console.error("Invalid category data for:",e),"{}";if("closing"===e||"postClosing"===e)return formatClosingChecklistData(e);var t=categoryData[e].map((function(e){return'"'.concat(e.key,'": "').concat(e.value.replace(/"/g,'\\"'),'"')})).join(",\n");return"{\n".concat(t,"\n}")}function formatClosingChecklistData(e){var t=categoryData[e];if(!Array.isArray(t))return console.error("Invalid selections data for category:",e),"{}";var n={};return t.forEach((function(e){if(e.mainHeading&&e.sectionHeading&&e.content){var t=e.mainHeading.trim(),r=e.sectionHeading.trim(),o=e.content.trim(),a=r.split(".").map((function(e){return e.trim()})),i=t.split(".").map((function(e){return e.trim()}));0!==a.length&&0!==i.length?(n[t]||(n[t]={title:t,sections:[]}),n[t].sections.push({sectionHeading:r,content:o})):console.error("Invalid section heading or main heading format:",e)}else console.error("Missing data in selection:",e)})),JSON.stringify(n,null,2)}function updateCategoryDisplay(e){var t=document.querySelector("#".concat(e,"Content .content-area"));t?(console.log("".concat(e," array:"),categoryData),t.innerHTML="",categoryData[e]&&categoryData[e].forEach((function(n){if("closing"===e||"postClosing"===e)[{key:"Article",value:n.mainHeading},{key:"Section",value:n.sectionHeading},{key:"Clause",value:n.content}].forEach((function(e){var n='<span class="key">'.concat(e.key,"</span>"),r='<span class="value">'.concat(e.value,"</span>"),o='<div class="pair">'.concat(n,": ").concat(r,"</div>");t.innerHTML+=o})),t.innerHTML+="<br><br>";else{var r='<span class="key">'.concat(n.key,"</span>"),o='<span class="value">'.concat(n.value,"</span>"),a='<div class="pair">'.concat(r,": ").concat(o,"</div>");t.innerHTML+=a}}))):console.error("Content element not found for category:",e)}function copyToClipboard(e){return _copyToClipboard.apply(this,arguments)}function _copyToClipboard(){return(_copyToClipboard=_asyncToGenerator(_regenerator().m((function e(t){var n;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:if(t){e.n=1;break}return console.error("No text provided to copy"),showCopyMessage(!1),e.a(2);case 1:return e.p=1,e.n=2,navigator.clipboard.writeText(t);case 2:showCopyMessage(!0),e.n=4;break;case 3:e.p=3,e.v,console.log("Fallback: using execCommand for copy"),(n=document.createElement("textarea")).value=t,n.style.position="fixed",n.style.left="-9999px",n.style.top="-9999px",document.body.appendChild(n);try{n.select(),showCopyMessage(document.execCommand("copy"))}catch(e){console.error("Failed to copy text:",e),showCopyMessage(!1)}finally{document.body.removeChild(n)}case 4:return e.a(2)}}),e,null,[[1,3]])})))).apply(this,arguments)}function showCopyMessage(e){var t=document.getElementById("copyMessage");t?(t.style.display="block",t.textContent=e?"Content added and copied to clipboard!":"Failed to copy content",t.style.color=e?"green":"red",setTimeout((function(){t.style.display="none"}),3e3)):console.error("Copy message element not found")}function clearCurrentContent(){return _clearCurrentContent.apply(this,arguments)}function _clearCurrentContent(){return(_clearCurrentContent=_asyncToGenerator(_regenerator().m((function e(){var t,n;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:if(t=document.getElementById("categorySelect").value){e.n=1;break}return console.log("No category selected"),e.a(2);case 1:return categoryData[t]=[],(n=document.querySelector("#".concat(t,"Content .content-area")))&&(n.innerHTML=""),e.n=2,silentCopyToClipboard("{}");case 2:console.log("Cleared content for category: ".concat(t));case 3:return e.a(2)}}),e)})))).apply(this,arguments)}Office.onReady((function(e){if(e.host===Office.HostType.Word){var t=document.getElementById("logStyleContentButton"),n=document.getElementById("categorySelect"),r=document.getElementById("reloadButton"),o=document.getElementById("dismissNotification"),a=document.getElementById("dealOptions");t.disabled=!0,t.onclick=getListInfoFromSelection,document.getElementById("clearContentButton").onclick=clearCurrentContent,r.onclick=handleReloadContent,o&&(o.onclick=dismissChangeNotification),n.onchange=handleCategoryChange,handleCategoryChange(),setInitialContentHash(),setInterval(checkForDocumentChanges,2e3),loadAllParagraphsData();var i=document.getElementById("loginButton"),s=document.getElementById("loginModal"),c=document.getElementById("loginForm"),l=document.querySelector(".close-modal"),u=document.getElementById("loginError");i.addEventListener("click",(function(){isLoggedIn?(isLoggedIn=!1,authToken=null,localStorage.removeItem("authToken"),i.textContent="Login To Deal Driver",a.style.display="none",document.getElementById("mainContent").classList.add("hidden")):s.style.display="block"})),l.addEventListener("click",(function(){s.style.display="none",u.style.display="none"})),window.addEventListener("click",(function(e){e.target===s&&(s.style.display="none",u.style.display="none")})),c.addEventListener("submit",function(){var e=_asyncToGenerator(_regenerator().m((function e(t){var n,r;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return t.preventDefault(),n=document.getElementById("userName").value,r=document.getElementById("password").value,e.n=1,handleLogin(n,r);case 1:e.v?(isLoggedIn=!0,i.textContent="Logout",s.style.display="none",u.style.display="none",c.reset(),a.style.display="block"):u.style.display="block";case 2:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}())}}));var selectedEnvironment,loginResponseData=null;function handleLogin(e,t){return _handleLogin.apply(this,arguments)}function _handleLogin(){return(_handleLogin=_asyncToGenerator(_regenerator().m((function e(t,n){var r,o,a,i,s,c,l,u;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,r=document.getElementById("environmentSelect"),selectedEnvironment=r.value,console.log("This is the selected Environment: ",selectedEnvironment),o="production"===selectedEnvironment?"https://deal-driver-20245869.api.drapcode.io/api/v1/developer/login":"preview"===selectedEnvironment?"https://deal-driver-20245869.api.preview.drapcode.io/api/v1/developer/login":"https://deal-driver-20245869.api.sandbox.drapcode.io/api/v1/developer/login",e.n=1,fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userName:t,password:n})});case 1:if(!(a=e.v).ok){e.n=3;break}return e.n=2,a.json();case 2:return s=e.v,console.log("This is the API response data",s),localStorage.setItem("loginResponseData",JSON.stringify(s)),loginResponseData=s,console.log("This is the login response variable: ",loginResponseData),localStorage.setItem("authToken",s.token),c=(null===(i=s.userDetails)||void 0===i?void 0:i.tenantId)||[],(l=document.getElementById("dealSelect")).innerHTML="",c.forEach((function(e){var t=document.createElement("option");t.value=e._id,console.log("These are the option value ",t.value),t.textContent=e.name,l.appendChild(t)})),c.length>0?document.getElementById("dealOptions").style.display="block":document.getElementById("dealOptions").style.display="none",document.getElementById("mainContent").classList.remove("hidden"),e.a(2,!0);case 3:return console.error("Login failed with status:",a.status),e.a(2,!1);case 4:e.n=6;break;case 5:return e.p=5,u=e.v,console.error("Login error:",u),e.a(2,!1);case 6:return e.a(2)}}),e,null,[[0,5]])})))).apply(this,arguments)}function togglePassword(){var e=document.getElementById("password");"password"===e.type?e.type="text":e.type="password"}sendDealButton.addEventListener("click",_asyncToGenerator(_regenerator().m((function e(){var t,n,r,o,a,i,s,c,l,u,d,p,g,y,f,m,h,v,_,b,C,k,I,T,D,S,E,w,x;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:if((t=document.getElementById("dealSendMessage"))||((t=document.createElement("div")).id="dealSendMessage",t.style.position="absolute",t.style.top="-50px",t.style.left="0",t.style.width="100%",t.style.padding="10px",t.style.textAlign="center",t.style.transition="top 0.3s ease",sendDealButton.parentNode.insertBefore(t,sendDealButton)),n=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t.textContent=e,t.style.backgroundColor=n?"#ffdddd":"#ddffdd",t.style.color=n?"red":"green",t.style.top="0",setTimeout((function(){t.style.top="-50px"}),9e3)},sendDealButton.disabled=!0,sendDealButton.style.opacity="0.5",sendDealButton.style.cursor="not-allowed",e.p=1,r=dealSelect.options[dealSelect.selectedIndex].text,o=document.getElementById("categorySelect").value,console.log("This is the selected category: ",o),a=localStorage.getItem("loginResponseData"),i=selectedEnvironment,console.log("Backend for selecting env: ",selectedEnvironment),a){e.n=2;break}return n("Login data not found",!0),e.a(2);case 2:if(s=JSON.parse(a),c=s.userDetails.tenantId||[],console.log("This is the dealsArray which contains all the data: ",c),l=c.find((function(e){return e.name===r})),console.log("This is the matched Deal: ",l),l){e.n=3;break}return n("Could not find matching deal",!0),e.a(2);case 3:if(u=l.deal[0].deal_user_setting,console.log("This is the matchedDealSettingUUID: ",u),"sandbox"===i?d="https://deal-driver-20245869.api.sandbox.drapcode.io":"preview"===i?d="https://deal-driver-20245869.api.preview.drapcode.io":"production"===i&&(d="https://deal-driver-20245869.api.drapcode.io"),console.log("This is the base url : ",d),!d){e.n=6;break}return e.n=4,fetch("".concat(d,"/api/v1/developer/collection/user_setting/item/").concat(u));case 4:return g=e.v,e.n=5,g.json();case 5:p=e.v,console.log("This is the dealSettingData: ",p),e.n=7;break;case 6:console.error("Invalid environment selected.");case 7:if(console.log("This is the final data before giving any error: ",p),y=p.permissions||[],f=["CREATE_POST_CLOSING_CHECKLIST","CREATE_REPRESENTATION_WARRANTY","CREATE_REVISED_CLOSING_CHECKLIST"],m=y.filter((function(e){return f.includes(e)})),console.log("Filtered AREA Permissions: ",m),h=l.deal[0].uuid,console.log("This is matched deal id: ",l.deal[0].uuid),v=s.tenant.uuid,"closing"!==o){e.n=13;break}return e.n=8,fetch("https://dealdriverapi.drapcode.co/addClosingData",{method:"POST",headers:{"Content-Type":"application/json",dealId:h,tenantId:v,environment:i,permissions:m},body:formatClosingChecklistData(o)});case 8:if(_=e.v,console.log("This is the body of the data being sent in the localhost: ",formatClosingChecklistData(o)),!_.ok){e.n=10;break}return e.n=9,_.json();case 9:b=e.v,n("".concat(o," data sent successfully to ").concat(r)),console.log("Server response:",b),e.n=12;break;case 10:return e.n=11,_.text();case 11:C=e.v,n("Error while sending the data",!0),console.error("Failed to send deal. Status: ".concat(_.status)),console.error("Error details:",C);case 12:console.log("This is the response data of the preview api",_),e.n=24;break;case 13:if("postClosing"!==o){e.n=19;break}return e.n=14,fetch("https://dealdriverapi.drapcode.co/addPostClosingData",{method:"POST",headers:{"Content-Type":"application/json",dealId:h,tenantId:v,environment:i,permissions:m},body:formatClosingChecklistData(o)});case 14:if(k=e.v,console.log("This is the body of the data being sent in the localhost: ",formatClosingChecklistData(o)),!k.ok){e.n=16;break}return e.n=15,k.json();case 15:I=e.v,n("".concat(o," data sent successfully to ").concat(r)),console.log("Server response:",I),e.n=18;break;case 16:return e.n=17,k.text();case 17:T=e.v,n("Error while sending the data",!0),console.error("Failed to send deal. Status: ".concat(k.status)),console.error("Error details:",T);case 18:console.log("This is the response data of the preview api",k),console.log("The selected Category is post closing"),e.n=24;break;case 19:return D=categoryData[o].reduce((function(e,t){return e[t.key]=t.value,e}),{}),console.log("This the formattedCategoryData that is being parsed before sending to the api: ",D),e.n=20,fetch("https://dealdriverapi.drapcode.co/parseWord",{method:"POST",headers:{"Content-Type":"application/json",dealId:h,tenantId:v,environment:i,permissions:m},body:JSON.stringify(D)});case 20:if(!(S=e.v).ok){e.n=22;break}return e.n=21,S.json();case 21:E=e.v,n("".concat(o," data sent successfully to ").concat(r)),console.log("Server response:",E),e.n=24;break;case 22:return e.n=23,S.text();case 23:w=e.v,n(w,!0),console.error("Failed to send deal. Status: ".concat(S.status)),console.error("Error details:",w);case 24:e.n=26;break;case 25:e.p=25,x=e.v,n("Error sending deal",!0),console.error("Error sending deal:",x);case 26:return e.p=26,sendDealButton.disabled=!1,sendDealButton.style.opacity="1",sendDealButton.style.cursor="pointer",e.f(26);case 27:return e.a(2)}}),e,null,[[1,25,26,27]])}))));